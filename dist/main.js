(()=>{function p(u,m=5,e=navigator.hardwareConcurrency||1){return new Promise((n,d)=>{let i=URL.createObjectURL(new Blob(["(",h(),")()"],{type:"application/javascript"})),r=[];for(let a=0;a<e;a++){let o=new Worker(i);o.onmessage=t=>{r.forEach(c=>c.terminate()),o.terminate(),n(t.data)},o.onerror=t=>{o.terminate(),d()},o.postMessage({data:u,difficulty:m,nonce:a,threads:e}),r.push(o)}URL.revokeObjectURL(i)})}function h(){return function(){let u=e=>{let n=new TextEncoder().encode(e);return crypto.subtle.digest("SHA-256",n.buffer)};function m(e){return Array.from(e).map(n=>n.toString(16).padStart(2,"0")).join("")}addEventListener("message",async e=>{let n=e.data.data,d=e.data.difficulty,i,r=e.data.nonce,a=e.data.threads;for(;;){let o=await u(n+r),t=new Uint8Array(o),c=!0;for(let s=0;s<d;s++){let l=Math.floor(s/2),f=s%2;if((t[l]>>(f===0?4:0)&15)!==0){c=!1;break}}if(c){i=m(t),console.log(i);break}r+=a}postMessage({hash:i,data:n,difficulty:d,nonce:r})})}.toString()}(async()=>{let u=document.getElementById("content"),m=document.getElementById("title"),e=JSON.parse(document.getElementById("challenge").textContent),n=JSON.parse(document.getElementById("difficulty").textContent),d=JSON.parse(document.getElementById("baseURL").textContent),i=Date.now(),{hash:r,nonce:a}=await p(e,n),o=Date.now();console.log({hash:r,nonce:a}),m.innerHTML="Success!",u.innerHTML=`Done! Took ${o-i}ms, ${a} iterations`;let t=document.createElement("form");t.method="POST",t.action=`${d}/answer`;let c=document.createElement("input");c.type="hidden",c.name="response",c.value=r;let s=document.createElement("input");s.type="hidden",s.name="nonce",s.value=a;let l=document.createElement("input");l.type="hidden",l.name="redir",l.value=window.location.href,t.appendChild(c),t.appendChild(s),t.appendChild(l),document.body.appendChild(t),setTimeout(()=>{t.submit()},250)})();})();
